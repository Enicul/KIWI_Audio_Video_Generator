# KIWI-Video 项目汇报

## 📌 项目概述

**KIWI-Video** 是一个基于多智能体架构的AI视频自动生成系统

> **一句话**: 输入文本描述 → 8-12分钟后 → 输出专业视频

---

## 🎯 核心创新：音频优先架构

### 传统流程的问题
```
脚本 → 分镜(估算8秒) → 生成视频(8秒) → 生成音频(实际7.5秒)
结果：❌ 音视频不同步，需要手动调整
```

### KIWI-Video解决方案
```
脚本 → 生成音频(实际7.5秒) → 基于实际时长分镜 → 生成视频(7.5秒)
结果：✅ 完美同步！
```

**核心优势**：先确定音频的精确时长，再生成匹配的视频，确保音视频完美同步

---

## 🔄 工作流程（5个阶段）

```
用户输入："创建一个关于未来科技的45秒视频"
        ↓
┌───────────────────────────────────────────────┐
│  DirectorOrchestrator 导演编排器              │
│  (协调4个AI智能体)                             │
└───────┬───────────────────────────────────────┘
        │
        ├─→ Phase 1: StoryLoader Agent     ⏱️ ~30秒
        │   └─ 生成5个场景的结构化脚本
        │
        ├─→ Phase 2: VoiceActor Agent      ⏱️ ~1分钟 ⭐
        │   └─ 为每个场景生成语音，获取精确时长
        │
        ├─→ Phase 3: Storyboard Agent      ⏱️ ~1分钟
        │   └─ 基于实际音频时长创建详细分镜
        │
        ├─→ Phase 4: FilmCrew Agent        ⏱️ ~5-8分钟
        │   └─ 调用Veo生成视频素材并合成
        │
        └─→ Phase 5: VideoProcessor        ⏱️ ~30秒
            └─ 拼接所有场景，输出最终视频
```

**总耗时**: 8-12分钟

---

## 🤖 四大智能体分工

| 智能体 | 职责 | 输入 | 输出 |
|--------|------|------|------|
| **StoryLoader** | 脚本创作 | 用户文本 | 5个结构化场景 |
| **VoiceActor** | 语音合成 | 场景文本 | 音频文件+精确时长 |
| **Storyboard** | 分镜设计 | 脚本+音频时长 | 镜头计划 |
| **FilmCrew** | 视频制作 | 分镜+音频 | 视频片段 |

---

## 🛠️ 技术栈

### AI服务
- **Google Gemini** - 脚本生成、分镜规划、智能决策
- **Google Veo** - 最先进的AI视频生成
- **ElevenLabs** - 高质量语音合成+识别

### 核心技术
- **Python 3.10+** - 完全异步处理
- **FastAPI** - REST API接口
- **Pydantic** - 类型安全验证
- **FFmpeg** - 视频处理

---

## 📊 性能指标

| 指标 | 时间 | 说明 |
|------|------|------|
| 脚本生成 | ~30秒 | Gemini LLM处理 |
| 音频生成 | ~1分钟 | 5个场景语音合成 |
| 分镜创建 | ~1分钟 | 基于实际音频时长规划 |
| 视频制作 | ~5-8分钟 | Veo生成（主要耗时） |
| 最终合成 | ~30秒 | FFmpeg视频拼接 |
| **总计** | **8-12分钟** | **端到端自动化** |

---

## 💡 技术亮点

### 1. 🎙️ 音频优先工作流
先生成音频获取精确时长，再基于实际时长生成视频，确保完美同步

### 2. 🤖 多智能体协作
4个专业AI智能体各司其职，模块化设计易于扩展

### 3. 💾 状态持久化
完整的状态管理，支持中断恢复和进度跟踪

### 4. ⚡ 全异步架构
高性能并发处理，充分利用系统资源

### 5. 🔌 模块化设计
易于添加新的AI服务提供商（LLM、视频生成、语音合成）

---

## 📁 输出文件结构

```
workspaces/project_name/
├── annotated_script.json      # 结构化脚本
├── style_guide.txt             # 风格指南
├── audio/                      # 音频文件
│   ├── scene_001_voice.mp3
│   └── scene_001_asr.json      # 语音识别时间戳
├── storyboard.json             # 完整分镜数据
├── plans/                      # 制作计划
├── assets/                     # 原始视频素材
├── clips/                      # 场景片段
└── final_video.mp4             # ✅ 最终视频
```

---

## 🎬 实际应用场景

- ✅ 营销宣传片自动生成
- ✅ 产品介绍视频快速制作
- ✅ 教育培训内容批量生产
- ✅ 社交媒体短视频创作
- ✅ 原型视频快速验证

---

## 🚀 使用方式

### 命令行
```bash
python test_full_workflow.py
# 输入提示词 → 等待8-12分钟 → 获得视频
```

### REST API
```bash
curl -X POST http://localhost:8000/api/v1/projects \
  -H "Content-Type: application/json" \
  -d '{"prompt": "创建一个关于AI的视频"}'
```

### Python SDK
```python
orchestrator = DirectorOrchestrator(project_id="demo")
result = await orchestrator.execute_project(
    user_input="创建一个关于未来的视频"
)
```

---

## 📈 项目成果

- ✅ **完全自动化**: 无需人工干预
- ✅ **音视频同步**: 音频优先架构保证完美同步
- ✅ **生产可用**: 稳定的状态管理和错误处理
- ✅ **可扩展**: 模块化设计，易于添加新功能
- ✅ **性能优秀**: 8-12分钟生成专业视频

---

## 🎯 项目总结

KIWI-Video通过**多智能体协作**和**音频优先架构**，实现了从文本到专业视频的全自动生成：

1. **创新的音频优先流程** - 解决音视频同步难题
2. **智能化的多智能体系统** - 各司其职，协同工作
3. **高效的异步处理** - 8-12分钟完成端到端生成
4. **完整的状态管理** - 可中断、可恢复、可追溯
5. **模块化设计** - 易于维护和扩展

**适用场景**: 需要批量生成视频内容的企业和创作者

